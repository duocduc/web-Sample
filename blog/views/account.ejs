<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>ユーザーアカウント</title>
    <link rel="stylesheet" href="/css/style.css" />
  </head>
  <body>
    <%- include('header'); %>
    <main>
      <div class="account-container">
        <% if (user.profile_image) { %>
        <img
          src="<%= user.profile_image %>"
          alt="プロフィール画像"
          class="profile-image"
        />
        <% } else { %>
        <img
          src="/images/default-profile.png"
          alt="デフォルトプロフィール画像"
          class="profile-image"
        />
        <% } %>

        <div class="user-info">
          <h1>アカウント情報</h1>
          <p><strong>ID:</strong> <%= user.id %></p>
          <p><strong>ユーザー名:</strong> <%= user.username %></p>
          <p><strong>メールアドレス:</strong> <%= user.email %></p>
          <a href="/edit-account/<%= user.id %>" class="back-link"
            >アカウント情報を編集する</a
          >
          <a href="/sell/<%= user.id %>" class="back-link">教科書販売</a>
          <% if (locals.username === "admin") { %>
          <a href="/rental" class="back-link">貸出本登録</a>
          <% } %> <a href="/list" class="back-link">リストへ戻る</a>
          <form action="/delete-account/<%= user.id %>" method="POST">
            <button
              type="submit"
              class="back-link"
              style="background-color: red"
            >
              アカウントを削除する
            </button>
          </form>
        </div>
      </div>
      <h2>販売中および販売済みの書籍</h2>
      <ul class="list">
        <% products.forEach((product) => { %>
        <li>
          <a href="/products/<%= product.id %>">
            <h2><%= product.title %></h2>
          <% if (product.image_path) { %>
          <img
            src="<%= product.image_path.split(';')[0] %>"
            alt="商品画像"
            width="200"
          />
          <% } %>
          <p><strong>価格:</strong> ¥<%= product.price %></p>
          <a href="/edit-product/<%= product.id %>" class="btn">編集</a>
        </li>
        <% }) %>
      </ul>
      <% if (locals.username === "admin") { %>
      <h2>貸出登録済み本</h2>
      <ul class="list">
        <% rentals.forEach((rental) => { %>
        <li>
          <a href="/rental/<%= rental.id %>">
          <h2><%= rental.title %></h2>
          <% if (rental.image_path) { %>
          <img
            src="<%= rental.image_path.split(';')[0] %>"
            alt="貸出本画像"
            width="200"
          />
          <% } %>
          <a href="/rental-edit/<%= rental.id %>" class="btn">編集</a>
        </li>
        <% }) %>
      </ul>
      <% } %>
    </main>
  </body>
</html>
